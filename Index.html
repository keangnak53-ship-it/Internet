<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Internet Company | Interactive Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
        @import url("https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&display=swap");

        body {
            font-family: "Inter", sans-serif;
            background-color: #080c14;
            color: #f1f5f9;
            overflow: hidden;
            margin: 0;
        }

        .system-font {
            font-family: "JetBrains Mono", monospace;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #1e293b;
            border-radius: 10px;
        }

        #formContainer {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 2000px;
            opacity: 1;
        }
        #formContainer.hidden-form {
            max-height: 0;
            opacity: 0;
            overflow: hidden;
            margin-bottom: 0;
            padding: 0;
        }

        #notification-box {
            position: fixed;
            bottom: 50px;
            right: 20px;
            z-index: 100;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .row-warning {
            background-color: rgba(239, 68, 68, 0.15) !important;
            border-left: 4px solid #ef4444;
        }
        .row-warning:hover {
            background-color: rgba(239, 68, 68, 0.25) !important;
        }
        
        input {
            transition: border-color 0.2s;
        }

        /* Modal Overlay */
        #confirmModal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(4px);
            z-index: 200;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body class="h-screen flex flex-col" onload="loadStoredData()">
    <!-- NOTIFICATION -->
    <div id="notification-box" class="glass-panel p-4 rounded-xl border-blue-500/30 shadow-2xl min-w-[300px]">
        <div class="flex items-center gap-3">
            <i class="fas fa-info-circle text-blue-400"></i>
            <span id="notification-text" class="text-xs system-font"></span>
        </div>
    </div>

    <!-- CONFIRMATION MODAL -->
    <div id="confirmModal">
        <div class="glass-panel p-8 rounded-3xl border-red-500/20 max-w-sm w-full mx-4 text-center">
            <div class="w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-exclamation-triangle text-red-500 text-2xl"></i>
            </div>
            <h3 class="text-xl font-bold text-white mb-2">Clear All Data?</h3>
            <p class="text-slate-400 text-sm mb-6">This action cannot be undone. All registry logs will be permanently deleted.</p>
            <div class="flex gap-3">
                <button onclick="closeModal()" class="flex-1 px-4 py-2 rounded-xl bg-slate-800 text-slate-300 text-xs font-bold uppercase tracking-widest hover:bg-slate-700 transition-all">Cancel</button>
                <button onclick="confirmClearAll()" class="flex-1 px-4 py-2 rounded-xl bg-red-600 text-white text-xs font-bold uppercase tracking-widest hover:bg-red-500 transition-all shadow-lg shadow-red-600/20">Delete All</button>
            </div>
        </div>
    </div>

    <!-- TOP NAV -->
    <header class="h-14 border-b border-slate-800 bg-slate-950 flex items-center justify-between px-6 shrink-0">
        <div class="flex items-center gap-6">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-700 rounded-lg flex items-center justify-center">
                    <i class="fas fa-globe text-white text-sm"></i>
                </div>
                <div>
                    <span class="system-font font-bold text-xs tracking-tighter uppercase block text-white">Internet Site Inclusion System</span>
                    <span class="text-[9px] text-slate-500 system-font uppercase">Control_Hub_v1.0.8</span>
                </div>
            </div>
        </div>
        <div class="flex items-center gap-3">
            <label class="flex items-center gap-2 bg-amber-600/10 hover:bg-amber-600/20 text-amber-400 border border-amber-500/20 px-4 py-1.5 rounded-lg system-font text-xs uppercase cursor-pointer transition-all active:scale-95">
                <i class="fas fa-file-import"></i> Import CSV
                <input type="file" id="csvFileInput" accept=".csv" class="hidden" onchange="importFromCSV(event)">
            </label>
            
            <button onclick="exportToExcel()" class="flex items-center gap-2 bg-emerald-600/10 hover:bg-emerald-600/20 text-emerald-400 border border-emerald-500/20 px-4 py-1.5 rounded-lg system-font text-xs uppercase transition-all active:scale-95">
                <i class="fas fa-file-excel"></i> Export Excel
            </button>
            <div class="hidden md:block text-blue-400 font-bold bg-blue-950/40 px-4 py-1.5 rounded-lg border border-blue-500/20 system-font text-xs uppercase">
                Active_Session
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <main class="flex-1 overflow-hidden flex flex-col bg-[#05080f]">
            <div class="flex-1 overflow-y-auto p-4 md:p-8">
                <div class="max-w-[1600px] mx-auto space-y-10">
                    
                    <div id="formContainer">
                        <div class="flex items-center justify-between mb-8">
                            <div>
                                <h1 class="text-2xl font-bold text-white tracking-tight">Node Setup Configuration</h1>
                                <p class="text-xs text-slate-500 system-font uppercase tracking-widest mt-1">Input parameters for the system registry</p>
                            </div>
                            <button onclick="toggleForm()" class="text-slate-400 hover:text-white text-xs system-font bg-slate-800/50 px-4 py-2 rounded-xl border border-slate-700 transition-all">
                                <i class="fas fa-eye-slash mr-2"></i> Minimize
                            </button>
                        </div>

                        <form id="entryForm" onsubmit="handleCommit(event)" class="space-y-6">
                            <!-- Mandatory Section -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Site Name <span class="text-red-500">*</span></label>
                                    <input type="text" id="siteName" required class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="Location Name..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Internet Company <span class="text-red-500">*</span></label>
                                    <input type="text" id="partner" required class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="Organization..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Register Date <span class="text-red-500">*</span></label>
                                    <input type="date" id="registerDate" required class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Expire Date <span class="text-red-500">*</span></label>
                                    <input type="date" id="expireDate" required class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" />
                                </div>
                            </div>

                            <!-- Network Details -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">IP Public</label>
                                    <input type="text" id="ipPublic" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="0.0.0.0" />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Gateway</label>
                                    <input type="text" id="gateway" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="0.0.0.0" />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">IP Private</label>
                                    <input type="text" id="ipPrivate" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="192.168.x.x" />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Speed</label>
                                    <input type="text" id="speed" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="e.g. 100Mbps" />
                                </div>
                            </div>

                            <!-- Access Details -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">System ID</label>
                                    <input type="text" id="entryId" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="ID..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Password</label>
                                    <input type="text" id="password" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="Password..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Subscription</label>
                                    <input type="text" id="requestSubscript" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="Monthly..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">User</label>
                                    <input type="text" id="user" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="Name..." />
                                </div>
                            </div>

                            <!-- Wireless & Support -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-5 gap-4">
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Wireless SSID</label>
                                    <input type="text" id="wirelessSsid" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="WiFi Name..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Wireless Password</label>
                                    <input type="text" id="wirelessPass" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="WiFi Pass..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">User Device</label>
                                    <input type="text" id="userDevice" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="Router/PC..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Pas Devices</label>
                                    <input type="text" id="pasDevices" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="Peripheral..." />
                                </div>
                                <div>
                                    <label class="block text-[10px] system-font text-slate-400 uppercase mb-2">Hotline</label>
                                    <input type="text" id="hotline" class="w-full px-4 py-3 bg-slate-900/50 border border-slate-800 rounded-xl text-white focus:outline-none focus:border-blue-500" placeholder="Support #..." />
                                </div>
                            </div>

                            <div class="flex justify-end pt-4">
                                <button type="submit" class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 px-12 rounded-2xl text-xs transition-all uppercase tracking-[0.3em] flex items-center gap-4 shadow-xl shadow-blue-600/20 active:scale-95 w-full md:w-auto justify-center">
                                    Commit Entry <i class="fas fa-plus-circle"></i>
                                </button>
                            </div>
                        </form>
                    </div>

                    <div class="space-y-6">
                        <div class="flex items-center justify-between px-2">
                            <h2 class="text-sm font-bold text-white tracking-widest uppercase flex items-center gap-3">
                                <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                                Registry Logs
                            </h2>
                            <div class="flex gap-3">
                                <button onclick="openClearModal()" class="text-red-400 hover:text-white text-[10px] system-font border border-red-500/20 px-4 py-2 rounded-xl bg-red-500/5 uppercase transition-all">
                                    <i class="fas fa-trash-sweep mr-2"></i> Clear All
                                </button>
                                <button id="showTerminalBtn" onclick="toggleForm()" class="hidden text-blue-400 hover:text-white text-[10px] system-font border border-blue-500/20 px-4 py-2 rounded-xl bg-blue-500/5 uppercase transition-all">
                                    <i class="fas fa-edit mr-2"></i> Open Configuration
                                </button>
                            </div>
                        </div>
                        <div class="glass-panel rounded-3xl border-slate-800/40 overflow-hidden shadow-2xl">
                            <div class="overflow-x-auto">
                                <table id="mainTable" class="w-full text-left whitespace-nowrap">
                                    <thead class="bg-slate-900/50 border-b border-slate-800/50 text-slate-500 system-font uppercase text-[9px] tracking-widest">
                                        <tr>
                                            <th class="px-4 py-4 w-12 text-center">NO</th>
                                            <th class="px-4 py-4">Site Name</th>
                                            <th class="px-4 py-4">Company</th>
                                            <th class="px-4 py-4">Reg Date</th>
                                            <th class="px-4 py-4">Exp Date</th>
                                            <th class="px-4 py-4">Subscription</th>
                                            <th class="px-4 py-4">User</th>
                                            <th class="px-4 py-4">Password</th>
                                            <th class="px-4 py-4">Public IP</th>
                                            <th class="px-4 py-4">Gateway</th>
                                            <th class="px-4 py-4">Private IP</th>
                                            <th class="px-4 py-4">System ID</th>
                                            <th class="px-4 py-4">Speed</th>
                                            <th class="px-4 py-4">Wireless SSID</th>
                                            <th class="px-4 py-4">Wireless Pass</th>
                                            <th class="px-4 py-4">User Device</th>
                                            <th class="px-4 py-4">Pas Devices</th>
                                            <th class="px-4 py-4">Hotline</th>
                                            <th class="px-4 py-4 text-center">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tableBody" class="divide-y divide-slate-800/30 text-[11px]"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="h-10 bg-slate-950 border-t border-slate-800 flex items-center px-8 justify-between text-[9px] system-font text-slate-500 uppercase tracking-widest">
                <span id="record-count">Records: 0</span>
                <div id="footer-time">00:00:00</div>
            </div>
        </main>
    </div>

    <script>
        const STORAGE_KEY = 'site_registry_data_v2';
        const FIELDS = [
            'siteName', 'partner', 'registerDate', 'expireDate', 'requestSubscript',
            'user', 'password', 'ipPublic', 'gateway', 'ipPrivate', 
            'entryId', 'speed', 'wirelessSsid', 'wirelessPass', 'userDevice', 'pasDevices', 'hotline'
        ];

        function updateTime() {
            document.getElementById("footer-time").innerText = new Date().toLocaleTimeString("en-GB");
        }
        setInterval(updateTime, 1000);

        function showNotification(msg) {
            const box = document.getElementById('notification-box');
            const txt = document.getElementById('notification-text');
            txt.innerText = msg;
            box.style.display = 'block';
            setTimeout(() => { box.style.display = 'none'; }, 3000);
        }

        function openClearModal() {
            const data = getStoredData();
            if (data.length === 0) {
                showNotification("No data to clear.");
                return;
            }
            document.getElementById('confirmModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('confirmModal').style.display = 'none';
        }

        function confirmClearAll() {
            saveToStorage([]);
            loadStoredData();
            closeModal();
            showNotification("Registry cleared.");
        }

        function exportToExcel() {
            const data = getStoredData();
            if (data.length === 0) {
                showNotification("No records found.");
                return;
            }

            let html = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="UTF-8">
                    <style>
                        table { border-collapse: collapse; }
                        th { background-color: #1e293b; color: #ffffff; font-weight: bold; border: 1px solid #000; padding: 8px; font-family: sans-serif; }
                        td { border: 1px solid #000; padding: 8px; font-family: sans-serif; }
                        .warning { background-color: #fecaca; color: #991b1b; }
                    </style>
                </head>
                <body>
                    <table>
                        <thead>
                            <tr><th>NO</th>${FIELDS.map(f => `<th>${f}</th>`).join('')}</tr>
                        </thead>
                        <tbody>
            `;

            data.slice().sort((a,b) => b.timestamp - a.timestamp).forEach((item, index) => {
                const regDate = new Date(item.registerDate);
                const expDate = new Date(item.expireDate);
                const isWarning = regDate >= expDate;
                html += `<tr ${isWarning ? 'class="warning"' : ''}>`;
                html += `<td>${index + 1}</td>`;
                FIELDS.forEach(field => {
                    html += `<td>${item[field] || ''}</td>`;
                });
                html += `</tr>`;
            });

            html += `</tbody></table></body></html>`;

            const blob = new Blob([html], { type: 'application/vnd.ms-excel' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = `Network_Logs_${new Date().toISOString().split('T')[0]}.xls`;
            link.click();
            showNotification("Excel exported.");
        }

        function importFromCSV(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                const lines = text.split('\n');
                const newEntries = [];
                for (let i = 1; i < lines.length; i++) {
                    const rowText = lines[i].trim();
                    if (!rowText) continue;
                    const values = rowText.split(',');
                    const entry = { timestamp: Date.now() + i };
                    FIELDS.forEach((key, index) => { 
                        let val = values[index] ? values[index].replace(/"/g, "").trim() : "";
                        if (key === 'user') {
                            const lowercaseVal = val.toLowerCase();
                            if (!val || lowercaseVal === 'null' || val === '-') {
                                entry[key] = "";
                            } else {
                                entry[key] = val;
                            }
                        } else {
                            entry[key] = val;
                        }
                    });
                    newEntries.push(entry);
                }
                if (newEntries.length > 0) {
                    const currentData = getStoredData();
                    saveToStorage([...currentData, ...newEntries]);
                    loadStoredData();
                    showNotification(`Imported ${newEntries.length} records.`);
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function getStoredData() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : [];
        }

        function saveToStorage(dataArray) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(dataArray));
            document.getElementById('record-count').innerText = `Records: ${dataArray.length}`;
        }

        function loadStoredData() {
            const data = getStoredData();
            const tableBody = document.getElementById("tableBody");
            tableBody.innerHTML = '';
            document.getElementById('record-count').innerText = `Records: ${data.length}`;
            if (data.length === 0) {
                tableBody.innerHTML = `<tr id="emptyRow"><td colspan="19" class="p-20 text-center text-slate-600 italic system-font">No logs available.</td></tr>`;
                return;
            }
            // Sort to show newest at top
            const sorted = data.slice().sort((a,b) => b.timestamp - a.timestamp);
            sorted.forEach((item, index) => { 
                appendRowToTable(item, index + 1); 
            });
        }

        function appendRowToTable(data, rowNumber) {
            const tableBody = document.getElementById("tableBody");
            const emptyRow = document.getElementById("emptyRow");
            if (emptyRow) emptyRow.remove();

            const regDate = new Date(data.registerDate);
            const expDate = new Date(data.expireDate);
            const isWarning = regDate >= expDate;

            const row = document.createElement("tr");
            row.dataset.id = data.timestamp;
            row.className = isWarning ? "row-warning text-red-300 group" : "hover:bg-slate-800/20 text-slate-300 group";
            
            // NO Column
            const noCell = document.createElement("td");
            noCell.className = "px-4 py-4 text-center system-font opacity-40 font-bold";
            noCell.innerText = rowNumber;
            row.appendChild(noCell);

            FIELDS.forEach(key => {
                const cell = document.createElement("td");
                cell.className = "px-4 py-4 system-font";
                const rawVal = data[key];
                const val = (rawVal === undefined || rawVal === null || rawVal === '') ? (key === 'user' ? '' : '-') : rawVal;

                if (key === 'siteName') cell.innerHTML = `<span class="${isWarning ? 'text-red-400' : 'text-white'} font-bold">${val}</span>`;
                else if (key === 'hotline') cell.innerHTML = `<span class="text-amber-400 font-semibold">${val}</span>`;
                else cell.innerText = val;
                row.appendChild(cell);
            });

            const actionCell = document.createElement("td");
            actionCell.className = "px-4 py-4 text-center";
            actionCell.innerHTML = `<button onclick="removeRow(this)" class="text-slate-600 hover:text-red-500 transition-colors p-2"><i class="fas fa-trash-alt"></i></button>`;
            row.appendChild(actionCell);
            
            tableBody.appendChild(row);
        }

        function handleCommit(e) {
            e.preventDefault();
            const formData = { timestamp: Date.now() };
            FIELDS.forEach(id => {
                const el = document.getElementById(id);
                if (el) formData[id] = el.value;
            });
            const currentData = getStoredData();
            currentData.push(formData);
            saveToStorage(currentData);
            loadStoredData();
            showNotification("Record saved.");
            e.target.reset();
        }

        function removeRow(btn) {
            const row = btn.closest('tr');
            const rowId = parseInt(row.dataset.id);
            let currentData = getStoredData();
            currentData = currentData.filter(item => item.timestamp !== rowId);
            saveToStorage(currentData);
            loadStoredData(); // Reload to update row numbers
            showNotification("Record purged.");
        }

        function toggleForm() {
            const form = document.getElementById("formContainer");
            const showBtn = document.getElementById("showTerminalBtn");
            const isHidden = form.classList.toggle("hidden-form");
            showBtn.classList.toggle("hidden", !isHidden);
        }
    </script>
</body>
</html>